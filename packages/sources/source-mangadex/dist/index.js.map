{"version":3,"sources":["../src/index.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["/**\n * @joyboy-parser/source-mangadex\n * MangaDex parser implementation\n * Compatible with Node.js, Browser, and React Native\n */\n\nimport { BaseSource } from '@joyboy-parser/core';\nimport type { Manga, Chapter, Page, SearchOptions, PaginationBase, Genre } from '@joyboy-parser/types';\n\n// MangaDex API response types\ninterface MangaDexManga {\n  id: string;\n  type: string;\n  attributes: {\n    title: Record<string, string>;\n    altTitles?: Array<Record<string, string>>;\n    description?: Record<string, string>;\n    isLocked: boolean;\n    links?: Record<string, string>;\n    officialLinks?: Record<string, string> | null;\n    originalLanguage: string;\n    lastVolume?: string;\n    lastChapter?: string;\n    publicationDemographic?: string | null;\n    status?: string;\n    year?: number;\n    contentRating?: string;\n    tags?: Array<{\n      id: string;\n      type: string;\n      attributes: {\n        name: Record<string, string>;\n        description?: Record<string, string>;\n        group?: string;\n        version?: number;\n      };\n      relationships: any[];\n    }>;\n  };\n  relationships: Array<{\n    type: string;\n    id: string;\n    attributes?: any;\n  }>;\n}\n\ninterface MangaDexChapter {\n  id: string;\n  type: string;\n  attributes: {\n    title?: string;\n    chapter?: string;\n    volume?: string;\n    translatedLanguage: string;\n    externalUrl?: string;\n    isUnavailable: boolean;\n    publishAt: string;\n    readableAt: string;\n    createdAt: string;\n    updatedAt: string;\n    pages: number;\n    version: number;\n  };\n  relationships: Array<{\n    type: string;\n    id?: string;\n    attributes?: {\n      name?: string;\n      altNames?: Array<Record<string, string>>;\n      locked?: boolean;\n      website?: string;\n      ircServer?: string | null;\n      ircChannel?: string | null;\n      discord?: string | null;\n      contactEmail?: string | null;\n      description?: string;\n      twitter?: string | null;\n      mangaUpdates?: string | null;\n      focusedLanguages?: string[];\n      official?: boolean;\n      verified?: boolean;\n      inactive?: boolean;\n      publishDelay?: string | null;\n      exLicensed?: boolean;\n      createdAt?: string;\n      updatedAt?: string;\n      version?: number;\n    };\n  }>;\n}\n\ninterface MangaDexPageResponse {\n  baseUrl: string;\n  chapter: {\n    hash: string;\n    data: string[];\n    dataSaver: string[];\n  };\n}\n\n/**\n * MangaDex source parser\n */\nexport default class MangaDexSource extends BaseSource {\n  getbyPage(searchLabel: string, pageNumber: number): Promise<Manga[]> {\n    throw new Error('Method not implemented.');\n  }\n\n  id = 'mangadex';\n  name = 'MangaDex';\n  version = '1.0.0';\n  baseUrl = 'https://api.mangadex.org';\n  icon = 'https://mangadex.org/favicon.ico';\n  description = 'Official MangaDex API parser';\n  languages = ['en'];\n\n  supportsSearch = true;\n  supportsTrending = false;\n  supportsLatest = true;\n  supportsFilters = true;\n  supportsPopular = true;\n\n  /**\n   * Search for manga on MangaDex\n   */\n  async search(query: string, options?: SearchOptions): Promise<Manga[]> {\n    const params: any = {\n      title: query,\n      limit: options?.limit || 20,\n      offset: options?.page ? (options.page - 1) * (options.limit || 20) : 0,\n      includes: ['cover_art', 'author', 'artist'],\n      contentRating: ['safe', 'suggestive']\n    };\n\n    const response = await this.request<{ data: MangaDexManga[] }>(\n      this.buildUrl('/manga', params)\n    );\n\n    return response.data.map(item => this.parseManga(item));\n  }\n\n  /**\n   * Get detailed manga information\n   */\n  async getMangaDetails(id: string): Promise<Manga> {\n    const response = await this.request<{ data: MangaDexManga }>(\n      this.buildUrl(`/manga/${id}`, {\n        includes: ['cover_art', 'author', 'artist']\n      })\n    );\n\n    return this.parseManga(response.data);\n  }\n\n  /**\n   * Get chapters for a manga\n   */\n  async getChapters(mangaId: string, offset: number = 0, limit: number = 100): Promise<Chapter[]> {\n    const allChapters: Chapter[] = [];\n\n    // MangaDex has pagination, fetch all chapters\n    while (true) {\n      const params: any = {\n        manga: mangaId,\n        translatedLanguage: ['en'],\n        order: { chapter: 'asc' },\n        limit,\n        offset,\n        includes: ['scanlation_group'],\n        contentRating: ['safe', 'suggestive', 'erotica', 'pornographic']\n      };\n\n      const response = await this.request<{\n        data: MangaDexChapter[];\n        limit: number;\n        offset: number;\n        total: number;\n      }>(this.buildUrl('/chapter', params));\n\n      allChapters.push(...response.data.map(item => this.parseChapter(item)));\n\n      if (offset + limit >= response.total) {\n        break;\n      }\n\n      offset += limit;\n    }\n\n    return allChapters;\n  }\n\n  /**\n   * Get pages for a chapter\n   */\n  async getChapterPages(chapterId: string): Promise<Page[]> {\n    // First, get chapter details to check for external URL\n    const chapterResponse = await this.request<{ data: MangaDexChapter }>(\n      this.buildUrl(`/chapter/${chapterId}`, {\n        includes: ['scanlation_group']\n      })\n    );\n\n    // If chapter has an external URL (e.g., MangaPlus), it's not available through MangaDex\n    if (chapterResponse.data.attributes.externalUrl) {\n      throw this.createError(\n        'NOT_FOUND',\n        `Chapter is hosted externally at: ${chapterResponse.data.attributes.externalUrl}. Please visit the external site to read this chapter.`,\n        undefined,\n        {\n          externalUrl: chapterResponse.data.attributes.externalUrl,\n          isExternal: true\n        }\n      );\n    }\n\n    const response = await this.request<MangaDexPageResponse>(\n      this.buildUrl(`/at-home/server/${chapterId}`)\n    );\n\n    const { baseUrl, chapter } = response;\n\n    return chapter.data.map((filename, index) => ({\n      index,\n      imageUrl: `${baseUrl}/data/${chapter.hash}/${filename}`,\n      headers: {\n        Referer: 'https://mangadex.org/'\n      }\n    }));\n  }\n\n\n  async sitema(){\n    // return this\n  }\n\n  /**\n   * Get latest manga updates\n   */\n  async getLatest(options?: SearchOptions): Promise<Manga[]> {\n    const params: any = {\n      limit: options?.limit || 20,\n      offset: options?.page ? (options.page - 1) * (options.limit || 20) : 0,\n      includes: ['cover_art', 'author', 'artist'],\n      order: { createdAt: 'desc' },\n      contentRating: ['safe', 'suggestive']\n    };\n\n    const response = await this.request<{ data: MangaDexManga[] }>(\n      this.buildUrl('/manga', params)\n    );\n\n    return response.data.map(item => this.parseManga(item));\n  }\n\n  /**\n   * Get popular manga\n   */\n  async getPopular(options?: SearchOptions): Promise<Manga[]> {\n    const params: any = {\n      limit: options?.limit || 20,\n      offset: options?.page ? (options.page - 1) * (options.limit || 20) : 0,\n      includes: ['cover_art', 'author', 'artist'],\n      order: { followedCount: 'desc' },\n      contentRating: ['safe', 'suggestive']\n    };\n\n    const response = await this.request<{ data: MangaDexManga[] }>(\n      this.buildUrl('/manga', params)\n    );\n\n    return response.data.map(item => this.parseManga(item));\n  }\n\n  /**\n   * Parse MangaDex manga data into standard format\n   */\n  private parseManga(data: MangaDexManga): Manga {\n    const title = data.attributes.title.en ||\n      Object.values(data.attributes.title)[0] ||\n      'Unknown';\n\n    const description = data.attributes.description?.en ||\n      (data.attributes.description ?\n        Object.values(data.attributes.description)[0] :\n        '');\n\n    const coverArt = data.relationships.find(r => r.type === 'cover_art');\n    const coverUrl = coverArt?.attributes?.fileName\n      ? `https://uploads.mangadex.org/covers/${data.id}/${coverArt.attributes.fileName}`\n      : undefined;\n\n    const author = data.relationships\n      .find(r => r.type === 'author')\n      ?.attributes?.name;\n\n    const artist = data.relationships\n      .find(r => r.type === 'artist')\n      ?.attributes?.name;\n\n    const genres = data.attributes.tags?.map(tag =>\n      tag.attributes.name.en || Object.values(tag.attributes.name)[0]\n    ) || [];\n\n    return {\n      id: data.id,\n      title,\n      coverUrl,\n      author,\n      artist,\n      genres,\n      description,\n      status: this.parseStatus(data.attributes.status),\n      year: data.attributes.year,\n      rating: this.parseRating(data.attributes.contentRating),\n      sourceId: this.id,\n      url: `https://mangadex.org/title/${data.id}`\n    };\n  }\n\n  /**\n   * Get manga by page number for a search term\n   */\n  async getByPage(searchLabel: string, pageNumber: number): Promise<Manga[]> {\n    return this.search(searchLabel, { page: pageNumber });\n  }\n\n  /**\n   * List all manga with optional filters\n   */\n  async listAll(options?: SearchOptions): Promise<Manga[]> {\n    const params: any = {\n      limit: options?.limit || 20,\n      offset: options?.page ? (options.page - 1) * (options.limit || 20) : 0,\n      includes: ['cover_art', 'author', 'artist'],\n      contentRating: ['safe', 'suggestive']\n    };\n\n    const response = await this.request<{ data: MangaDexManga[] }>(\n      this.buildUrl('/manga', params)\n    );\n\n    return response.data.map(item => this.parseManga(item));\n  }\n\n  /**\n   * Extract pagination information from API response\n   */\n  async extractPaginationInfo(url: string): Promise<PaginationBase> {\n    try {\n      const response = await this.request<{\n        limit: number;\n        offset: number;\n        total: number;\n      }>(url);\n\n      const totalPages = Math.ceil(response.total / response.limit);\n\n      return {\n        totalPages\n      };\n    } catch (error) {\n      // Return default pagination if extraction fails\n      return { totalPages: 1 };\n    }\n  }\n\n  // listGenres(){\n\n  // }\n\n  listGenres(): Promise<Genre[]> {\n    throw new Error(\"not implemented\")\n  }\n\n  /**\n   * Parse MangaDex chapter data\n   */\n  private parseChapter(data: MangaDexChapter): Chapter {\n    const scanlator = data.relationships\n      .find(r => r.type === 'scanlation_group')\n      ?.attributes?.name;\n\n    const chapterNum = data.attributes.chapter ?\n      parseFloat(data.attributes.chapter) :\n      undefined;\n\n    const volumeNum = data.attributes.volume ?\n      parseInt(data.attributes.volume) :\n      undefined;\n\n    return {\n      id: data.id,\n      title: data.attributes.title || `Chapter ${chapterNum || '?'}`,\n      number: chapterNum,\n      volume: volumeNum,\n      date: data.attributes.publishAt,\n      pages: data.attributes.pages,\n      scanlator,\n      language: data.attributes.translatedLanguage,\n      url: `https://mangadex.org/chapter/${data.id}`,\n      externalUrl: data.attributes.externalUrl\n    };\n  }\n\n  /**\n   * Parse status string to standard format\n   */\n  private parseStatus(status?: string): Manga['status'] {\n    switch (status?.toLowerCase()) {\n      case 'ongoing': return 'ongoing';\n      case 'completed': return 'completed';\n      case 'hiatus': return 'hiatus';\n      case 'cancelled': return 'cancelled';\n      default: return 'unknown';\n    }\n  }\n\n  /**\n   * Parse content rating\n   */\n  private parseRating(rating?: string): Manga['rating'] {\n    switch (rating?.toLowerCase()) {\n      case 'safe': return 'safe';\n      case 'suggestive': return 'suggestive';\n      case 'erotica': return 'erotica';\n      case 'pornographic': return 'pornographic';\n      default: return 'safe';\n    }\n  }\n}\n"]}