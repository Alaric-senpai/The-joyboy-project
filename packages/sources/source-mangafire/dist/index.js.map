{"version":3,"sources":["../src/index.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["/**\n * @joyboy-parser/source-mangafire\n * MangaFire.to parser implementation\n * Compatible with Node.js, Browser, and React Native\n * \n * Website: https://mangafire.to\n * Features: 52k+ manga titles, free, no ads\n */\n\nimport { BaseSource } from '@joyboy-parser/core';\nimport type { Manga, Chapter, Page, SearchOptions, PaginationBase, Genre } from '@joyboy-parser/types';\n\n// MangaFire genre mapping\nconst GENRES: Genre[] = [\n\t{ label: 'Action', id: 1 },\n\t{ label: 'Adventure', id: 2 },\n\t{ label: 'Comedy', id: 3 },\n\t{ label: 'Drama', id: 4 },\n\t{ label: 'Fantasy', id: 5 },\n\t{ label: 'Horror', id: 6 },\n\t{ label: 'Mystery', id: 7 },\n\t{ label: 'Romance', id: 8 },\n\t{ label: 'Sci-Fi', id: 9 },\n\t{ label: 'Slice of Life', id: 10 },\n\t{ label: 'Sports', id: 11 },\n\t{ label: 'Supernatural', id: 12 },\n\t{ label: 'Thriller', id: 13 },\n\t{ label: 'Psychological', id: 14 },\n\t{ label: 'School Life', id: 15 },\n\t{ label: 'Shounen', id: 16 },\n\t{ label: 'Shoujo', id: 17 },\n\t{ label: 'Seinen', id: 18 },\n\t{ label: 'Josei', id: 19 },\n\t{ label: 'Isekai', id: 20 },\n\t{ label: 'Martial Arts', id: 21 },\n\t{ label: 'Mecha', id: 22 },\n\t{ label: 'Military', id: 23 },\n\t{ label: 'Music', id: 24 },\n\t{ label: 'Ecchi', id: 25 },\n\t{ label: 'Harem', id: 26 },\n\t{ label: 'Historical', id: 27 },\n\t{ label: 'Super Power', id: 28 },\n];\n\n/**\n * MangaFire source parser\n * Scrapes manga data from mangafire.to\n */\nexport default class MangaFireSource extends BaseSource {\n\tid = 'mangafire';\n\tname = 'MangaFire';\n\tversion = '1.0.0';\n\tbaseUrl = 'https://mangafire.to';\n\ticon = 'https://mangafire.to/assets/sites/mangafire/favicon.ico';\n\tdescription = 'MangaFire - Free manga reader with 52k+ titles';\n\tlanguages = ['en'];\n\tisNsfw = false;\n\n\t// Capabilities\n\tsupportsSearch = true;\n\tsupportsTrending = true;\n\tsupportsLatest = true;\n\tsupportsFilters = true;\n\tsupportsPopular = true;\n\n\t// Default headers to bypass 403 blocks\n\tprivate defaultHeaders: Record<string, string> = {\n\t\t'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',\n\t\t'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8',\n\t\t'Accept-Language': 'en-US,en;q=0.9',\n\t\t'Referer': 'https://mangafire.to/',\n\t\t'DNT': '1',\n\t\t'Connection': 'keep-alive',\n\t\t'Upgrade-Insecure-Requests': '1'\n\t};\n\n\t/**\n\t * Override fetchHtml to include proper headers\n\t */\n\tprotected async fetchHtmlWithHeaders(url: string): Promise<string> {\n\t\treturn this.fetchHtml(url, { headers: this.defaultHeaders });\n\t}\n\n\t/**\n\t * Search for manga on MangaFire\n\t * URL pattern: /filter?keyword={query}&page={page}\n\t */\n\tasync search(query: string, options?: SearchOptions): Promise<Manga[]> {\n\t\tconst page = options?.page || 1;\n\t\tconst params: Record<string, any> = {\n\t\t\tkeyword: query,\n\t\t\tpage: page\n\t\t};\n\n\t\t// Add genre filters if specified\n\t\tif (options?.includedGenres && options.includedGenres.length > 0) {\n\t\t\tparams.genre = options.includedGenres.join(',');\n\t\t}\n\n\t\t// Add status filter\n\t\tif (options?.status) {\n\t\t\tconst statusMap: Record<string, string> = {\n\t\t\t\t'ongoing': 'releasing',\n\t\t\t\t'completed': 'completed',\n\t\t\t\t'hiatus': 'on_hiatus',\n\t\t\t\t'cancelled': 'discontinued'\n\t\t\t};\n\t\t\tparams.status = statusMap[options.status] || options.status;\n\t\t}\n\n\t\t// Add sort option\n\t\tif (options?.sort) {\n\t\t\tconst sortMap: Record<string, string> = {\n\t\t\t\t'latest': 'recently_updated',\n\t\t\t\t'popular': 'most_viewed',\n\t\t\t\t'rating': 'scores',\n\t\t\t\t'alphabetical': 'title_az'\n\t\t\t};\n\t\t\tparams.sort = sortMap[options.sort] || 'most_viewed';\n\t\t}\n\n\t\tconst url = this.buildUrl('/filter', params);\n\t\tconst html = await this.fetchHtmlWithHeaders(url);\n\t\treturn this.parseSearchResults(html)\n\t}\n\n\t/**\n\t * Get detailed manga information\n\t * URL pattern: /manga/{slug}.{id}\n\t */\n\tasync getMangaDetails(id: string): Promise<Manga> {\n\t\t// id format: \"slug.shortId\" e.g., \"one-piecee.dkw\"\n\t\tconst url = `${this.baseUrl}/manga/${id}`;\n\t\tconst html = await this.fetchHtmlWithHeaders(url);\n\t\treturn this.parseMangaDetails(html, id);\n\t}\n\n\t/**\n\t * Get chapters for a manga\n\t * Chapters are embedded in the manga page\n\t */\n\tasync getChapters(mangaId: string): Promise<Chapter[]> {\n\t\tconst url = `${this.baseUrl}/manga/${mangaId}`;\n\t\tconst html = await this.fetchHtmlWithHeaders(url);\n\t\treturn this.parseChapters(html, mangaId);\n\t}\n\n\t/**\n\t * Get pages for a chapter\n\t * URL pattern: /read/{slug}.{id}/{lang}/chapter-{num}\n\t */\n\tasync getChapterPages(chapterId: string): Promise<Page[]> {\n\t\t// chapterId format: \"slug.id/en/chapter-num\" e.g., \"one-piecee.dkw/en/chapter-1173\"\n\t\tconst url = `${this.baseUrl}/read/${chapterId}`;\n\t\tconst html = await this.fetchHtmlWithHeaders(url);\n\t\treturn this.parseChapterPages(html);\n\t}\n\n\t/**\n\t * Get manga by page (pagination helper)\n\t */\n\tasync getByPage(searchLabel: string, pageNumber: number): Promise<Manga[]> {\n\t\treturn this.search(searchLabel, { page: pageNumber });\n\t}\n\n\t/**\n\t * List all manga with pagination\n\t */\n\tasync listAll(options?: SearchOptions): Promise<Manga[]> {\n\t\tconst page = options?.page || 1;\n\t\tconst url = this.buildUrl('/filter', { page, sort: 'most_viewed' });\n\t\tconst html = await this.fetchHtmlWithHeaders(url);\n\t\treturn this.parseSearchResults(html);\n\t}\n\n\t/**\n\t * Get trending manga\n\t */\n\tasync getTrending(options?: SearchOptions): Promise<Manga[]> {\n\t\tconst page = options?.page || 1;\n\t\tconst url = this.buildUrl('/filter', { page, sort: 'trending' });\n\t\tconst html = await this.fetchHtmlWithHeaders(url);\n\t\treturn this.parseSearchResults(html);\n\t}\n\n\t/**\n\t * Get latest updated manga\n\t */\n\tasync getLatest(options?: SearchOptions): Promise<Manga[]> {\n\t\tconst page = options?.page || 1;\n\t\tconst url = this.buildUrl('/filter', { page, sort: 'recently_updated' });\n\t\tconst html = await this.fetchHtmlWithHeaders(url);\n\t\treturn this.parseSearchResults(html);\n\t}\n\n\t/**\n\t * Get popular manga\n\t */\n\tasync getPopular(options?: SearchOptions): Promise<Manga[]> {\n\t\tconst page = options?.page || 1;\n\t\tconst url = this.buildUrl('/filter', { page, sort: 'most_viewed' });\n\t\tconst html = await this.fetchHtmlWithHeaders(url);\n\t\treturn this.parseSearchResults(html);\n\t}\n\n\t/**\n\t * List available genres\n\t */\n\tasync listGenres(): Promise<Genre[]> {\n\t\treturn GENRES;\n\t}\n\n\t/**\n\t * Extract pagination info from a page\n\t */\n\tasync extractPaginationInfo(url: string): Promise<PaginationBase> {\n\t\tconst html = await this.fetchHtmlWithHeaders(url);\n\t\tconst doc = this.parseHtmlDoc(html);\n\n\t\t// Look for pagination elements\n\t\tconst pagination = doc.querySelector('.pagination, .page-item, nav[aria-label=\"pagination\"]');\n\t\tif (!pagination) {\n\t\t\treturn { totalPages: 1, currentPage: 1, hasNextPage: false, hasPreviousPage: false };\n\t\t}\n\n\t\t// Try to find last page number\n\t\tconst pageLinks = doc.querySelectorAll('.pagination a, .page-link');\n\t\tlet maxPage = 1;\n\t\tlet currentPage = 1;\n\n\t\tpageLinks.forEach((link: any) => {\n\t\t\tconst text = link.textContent?.trim();\n\t\t\tconst pageNum = parseInt(text || '0', 10);\n\t\t\tif (!isNaN(pageNum) && pageNum > maxPage) {\n\t\t\t\tmaxPage = pageNum;\n\t\t\t}\n\t\t\tif (link.classList?.contains('active') || link.parentElement?.classList?.contains('active')) {\n\t\t\t\tcurrentPage = pageNum || currentPage;\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\ttotalPages: maxPage,\n\t\t\tcurrentPage,\n\t\t\thasNextPage: currentPage < maxPage,\n\t\t\thasPreviousPage: currentPage > 1\n\t\t};\n\t}\n\n\t// --- Private parsing methods ---\n\n\t/**\n\t * Parse search/filter results page\n\t */\n\tprivate parseSearchResults(html: string): Manga[] {\n\t\tconst doc = this.parseHtmlDoc(html);\n\t\tconst mangaList: Manga[] = [];\n\n\t\t// Select manga cards - MangaFire uses various container classes\n\t\tconst mangaCards = doc.querySelectorAll('.manga-poster, .unit, .original.card-lg, .inner');\n\n\t\tmangaCards.forEach((card: any) => {\n\t\t\ttry {\n\t\t\t\t// Find the link element\n\t\t\t\tconst linkEl = card.querySelector('a[href*=\"/manga/\"]') || card.closest('a[href*=\"/manga/\"]');\n\t\t\t\tif (!linkEl) return;\n\n\t\t\t\tconst href = linkEl.getAttribute('href') || '';\n\t\t\t\t// Extract id from URL: /manga/title-slug.id -> title-slug.id\n\t\t\t\tconst idMatch = href.match(/\\/manga\\/([^\\/]+)$/);\n\t\t\t\tif (!idMatch) return;\n\n\t\t\t\tconst id = idMatch[1];\n\n\t\t\t\t// Get title\n\t\t\t\tconst titleEl = card.querySelector('.manga-name, .title, h3, h6, .name') || linkEl;\n\t\t\t\tconst title = titleEl?.textContent?.trim() || titleEl?.getAttribute('title') || '';\n\n\t\t\t\t// Get cover image\n\t\t\t\tconst imgEl = card.querySelector('img');\n\t\t\t\tconst coverUrl = imgEl?.getAttribute('src') || \n\t\t\t\t\timgEl?.getAttribute('data-src') || \n\t\t\t\t\timgEl?.getAttribute('data-lazy-src') || '';\n\n\t\t\t\tif (title && id) {\n\t\t\t\t\tmangaList.push({\n\t\t\t\t\t\tid,\n\t\t\t\t\t\ttitle,\n\t\t\t\t\t\tcoverUrl,\n\t\t\t\t\t\tsourceId: this.id,\n\t\t\t\t\t\turl: `${this.baseUrl}/manga/${id}`\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t// Skip problematic entries\n\t\t\t}\n\t\t});\n\n\t\treturn mangaList;\n\t}\n\n\t/**\n\t * Parse manga details page\n\t */\n\tprivate parseMangaDetails(html: string, id: string): Manga {\n\t\tconst doc = this.parseHtmlDoc(html);\n\n\t\t// Get title - try multiple selectors\n\t\tconst titleEl = doc.querySelector('h1, .manga-name, .name, [itemprop=\"name\"]');\n\t\tconst title = titleEl?.textContent?.trim() || '';\n\n\t\t// Get alternative titles\n\t\tconst altTitleEl = doc.querySelector('h6, .alt-name, .other-name');\n\t\tconst altTitles = altTitleEl?.textContent?.split(';').map((t: string) => t.trim()).filter(Boolean) || [];\n\n\t\t// Get cover image\n\t\tconst coverEl = doc.querySelector('.poster img, .manga-poster img, img.manga-cover, .cover img');\n\t\tconst coverUrl = coverEl?.getAttribute('src') || coverEl?.getAttribute('data-src') || '';\n\n\t\t// Get description/synopsis\n\t\tconst descEl = doc.querySelector('.description, .synopsis, [itemprop=\"description\"], .summary, .content');\n\t\tconst description = descEl?.textContent?.trim() || '';\n\n\t\t// Get author\n\t\tconst authorEl = doc.querySelector('a[href*=\"/author/\"], .author a, [itemprop=\"author\"]');\n\t\tconst author = authorEl?.textContent?.trim() || '';\n\n\t\t// Get genres\n\t\tconst genreEls = doc.querySelectorAll('a[href*=\"/genre/\"], .genres a, .tags a');\n\t\tconst genres: string[] = [];\n\t\tgenreEls.forEach((el: any) => {\n\t\t\tconst genre = el.textContent?.trim();\n\t\t\tif (genre) genres.push(genre);\n\t\t});\n\n\t\t// Get status\n\t\tlet status: Manga['status'] = 'unknown';\n\t\tconst statusEl = doc.querySelector('.info-item:has(.status), .status, [data-status]');\n\t\tconst statusText = statusEl?.textContent?.toLowerCase() || '';\n\t\tif (statusText.includes('ongoing') || statusText.includes('releasing')) {\n\t\t\tstatus = 'ongoing';\n\t\t} else if (statusText.includes('completed') || statusText.includes('finished')) {\n\t\t\tstatus = 'completed';\n\t\t} else if (statusText.includes('hiatus')) {\n\t\t\tstatus = 'hiatus';\n\t\t} else if (statusText.includes('cancelled') || statusText.includes('discontinued')) {\n\t\t\tstatus = 'cancelled';\n\t\t}\n\n\t\t// Get year\n\t\tconst yearMatch = html.match(/Published:\\s*(\\w+\\s+\\d+,\\s+)?(\\d{4})/i) || \n\t\t\thtml.match(/(\\d{4})\\s+to/i);\n\t\tconst year = yearMatch ? parseInt(yearMatch[2] || yearMatch[1], 10) : undefined;\n\n\t\t// Get rating\n\t\tconst ratingEl = doc.querySelector('.score, .rating, [itemprop=\"ratingValue\"]');\n\t\tconst ratingText = ratingEl?.textContent?.trim();\n\n\t\treturn {\n\t\t\tid,\n\t\t\ttitle,\n\t\t\taltTitles: altTitles.length > 0 ? altTitles : undefined,\n\t\t\tcoverUrl,\n\t\t\tauthor,\n\t\t\tgenres: genres.length > 0 ? genres : undefined,\n\t\t\tdescription,\n\t\t\tstatus,\n\t\t\tsourceId: this.id,\n\t\t\turl: `${this.baseUrl}/manga/${id}`,\n\t\t\tyear,\n\t\t\tmetadata: ratingText ? { rating: ratingText } : undefined\n\t\t};\n\t}\n\n\t/**\n\t * Parse chapters from manga page\n\t */\n\tprivate parseChapters(html: string, mangaId: string): Chapter[] {\n\t\tconst doc = this.parseHtmlDoc(html);\n\t\tconst chapters: Chapter[] = [];\n\n\t\t// MangaFire lists chapters with links like /read/{slug}.{id}/{lang}/chapter-{num}\n\t\tconst chapterLinks = doc.querySelectorAll('a[href*=\"/read/\"]');\n\n\t\tchapterLinks.forEach((link: any, index: number) => {\n\t\t\ttry {\n\t\t\t\tconst href = link.getAttribute('href') || '';\n\t\t\t\t// Extract chapter info from URL: /read/one-piecee.dkw/en/chapter-1173\n\t\t\t\tconst match = href.match(/\\/read\\/([^\\/]+)\\/(\\w+)\\/chapter-([\\d.]+)/);\n\t\t\t\tif (!match) return;\n\n\t\t\t\tconst [, slug, lang, chapterNum] = match;\n\n\t\t\t\t// Build chapter ID (path after /read/)\n\t\t\t\tconst chapterId = `${slug}/${lang}/chapter-${chapterNum}`;\n\n\t\t\t\t// Get chapter title from link text\n\t\t\t\tconst titleText = link.textContent?.trim() || '';\n\t\t\t\t// Extract title part after \"Chapter X:\"\n\t\t\t\tconst titleMatch = titleText.match(/Chapter\\s+[\\d.]+[:\\s]*(.+)?/i);\n\t\t\t\tconst chapterTitle = titleMatch?.[1]?.trim() || `Chapter ${chapterNum}`;\n\n\t\t\t\t// Try to get date\n\t\t\t\tconst dateEl = link.querySelector('.date, time, .chapter-date') || \n\t\t\t\t\tlink.parentElement?.querySelector('.date, time, .chapter-date');\n\t\t\t\tconst dateText = dateEl?.textContent?.trim() || dateEl?.getAttribute('datetime');\n\n\t\t\t\tchapters.push({\n\t\t\t\t\tid: chapterId,\n\t\t\t\t\ttitle: chapterTitle,\n\t\t\t\t\tnumber: parseFloat(chapterNum),\n\t\t\t\t\turl: `${this.baseUrl}/read/${chapterId}`,\n\t\t\t\t\tdate: dateText,\n\t\t\t\t\tlanguage: lang\n\t\t\t\t});\n\t\t\t} catch (e) {\n\t\t\t\t// Skip problematic chapters\n\t\t\t}\n\t\t});\n\n\t\t// Remove duplicates and sort by chapter number descending (newest first)\n\t\tconst uniqueChapters = chapters.filter((ch, idx, arr) => \n\t\t\tarr.findIndex(c => c.id === ch.id) === idx\n\t\t);\n\t\t\n\t\treturn uniqueChapters.sort((a, b) => (b.number || 0) - (a.number || 0));\n\t}\n\n\t/**\n\t * Parse chapter pages\n\t * MangaFire loads images dynamically, we need to extract from script or data attributes\n\t */\n\tprivate parseChapterPages(html: string): Page[] {\n\t\tconst pages: Page[] = [];\n\n\t\t// Try to find image URLs in script tags (common pattern for manga readers)\n\t\t// Look for JSON data or array of image URLs\n\t\tconst scriptMatch = html.match(/images\\s*[=:]\\s*(\\[[\\s\\S]*?\\])/i) ||\n\t\t\thtml.match(/pages\\s*[=:]\\s*(\\[[\\s\\S]*?\\])/i) ||\n\t\t\thtml.match(/chapter\\s*[=:]\\s*{[\\s\\S]*?images\\s*[=:]\\s*(\\[[\\s\\S]*?\\])/i);\n\n\t\tif (scriptMatch) {\n\t\t\ttry {\n\t\t\t\t// Clean and parse JSON\n\t\t\t\tconst jsonStr = scriptMatch[1]\n\t\t\t\t\t.replace(/'/g, '\"')\n\t\t\t\t\t.replace(/,\\s*]/, ']');\n\t\t\t\tconst imageUrls: any[] = JSON.parse(jsonStr);\n\t\t\t\t\n\t\t\t\timageUrls.forEach((item: any, index: number) => {\n\t\t\t\t\tif (typeof item === 'string' && item.startsWith('http')) {\n\t\t\t\t\t\tpages.push({\n\t\t\t\t\t\t\tindex,\n\t\t\t\t\t\t\timageUrl: item\n\t\t\t\t\t\t});\n\t\t\t\t\t} else if (typeof item === 'object' && item !== null && item.url) {\n\t\t\t\t\t\tpages.push({\n\t\t\t\t\t\t\tindex,\n\t\t\t\t\t\t\timageUrl: item.url\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} catch (e) {\n\t\t\t\t// JSON parse failed, try alternative methods\n\t\t\t}\n\t\t}\n\n\t\t// Fallback: Parse img tags directly\n\t\tif (pages.length === 0) {\n\t\t\tconst doc = this.parseHtmlDoc(html);\n\t\t\tconst imgEls = doc.querySelectorAll('.reader-area img, .container-reader img, #readerarea img, .page-img, img[data-page]');\n\t\t\t\n\t\t\timgEls.forEach((img: any, index: number) => {\n\t\t\t\tconst src = img.getAttribute('src') || \n\t\t\t\t\timg.getAttribute('data-src') || \n\t\t\t\t\timg.getAttribute('data-lazy-src');\n\t\t\t\t\n\t\t\t\tif (src && (src.startsWith('http') || src.startsWith('//'))) {\n\t\t\t\t\tpages.push({\n\t\t\t\t\t\tindex,\n\t\t\t\t\t\timageUrl: src.startsWith('//') ? `https:${src}` : src\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// Another fallback: Look for data-* attributes with page info\n\t\tif (pages.length === 0) {\n\t\t\tconst doc = this.parseHtmlDoc(html);\n\t\t\tconst pageContainers = doc.querySelectorAll('[data-page-image], [data-img], [data-url]');\n\t\t\t\n\t\t\tpageContainers.forEach((el: any, index: number) => {\n\t\t\t\tconst src = el.getAttribute('data-page-image') || \n\t\t\t\t\tel.getAttribute('data-img') || \n\t\t\t\t\tel.getAttribute('data-url');\n\t\t\t\t\n\t\t\t\tif (src) {\n\t\t\t\t\tpages.push({\n\t\t\t\t\t\tindex,\n\t\t\t\t\t\timageUrl: src.startsWith('//') ? `https:${src}` : src\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn pages;\n\t}\n\n\t/**\n\t * Parse HTML string to DOM document\n\t */\n\tprivate parseHtmlDoc(html: string): any {\n\t\t// Use the inherited transformToHtml method from BaseSource\n\t\tconst parsed = (this as any).transformToHtml(html);\n\t\treturn parsed.document;\n\t}\n}\n"]}